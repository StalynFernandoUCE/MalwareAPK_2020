
--
--[[--

 	å…¨å±€è®¡æ—¶å™¨ã€è®¡åˆ’ä»»åŠ¡

]]
local Scheduler = {}

local schedulerIns = cc.Director:getInstance():getScheduler()

--[[--

è®¡åˆ’ä¸€ä¸ªå…¨å±€å¸§äº‹ä»¶å›è°ƒï¼Œå¹¶è¿”å›è¯¥è®¡åˆ’çš„å¥æŸ„ã€‚

å…¨å±€å¸§äº‹ä»¶åœ¨ä»»ä½•åœºæ™¯ä¸­éƒ½ä¼šæ‰§è¡Œï¼Œå› æ­¤å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºèŒƒå›´å†…å®ç°è¾ƒä¸ºç²¾ç¡®çš„å…¨å±€è®¡æ—¶å™¨ã€‚

è¯¥å‡½æ•°è¿”å›çš„å¥æŸ„ç”¨ä½œ Scheduler.unscheduleGlobal() çš„å‚æ•°ï¼Œå¯ä»¥å–æ¶ˆæŒ‡å®šçš„è®¡åˆ’ã€‚

@param function å›è°ƒå‡½æ•°

@return mixed scheduleå¥æŸ„

]]
function Scheduler.scheduleUpdateGlobal(listener)
    return schedulerIns:scheduleScriptFunc(listener, 0, false)
end

--[[--

è®¡åˆ’ä¸€ä¸ªä»¥æŒ‡å®šæ—¶é—´é—´éš”æ‰§è¡Œçš„å…¨å±€äº‹ä»¶å›è°ƒï¼Œå¹¶è¿”å›è¯¥è®¡åˆ’çš„å¥æŸ„ã€‚

~~~ lua

local function onInterval(dt)
end

-- æ¯ 0.5 ç§’æ‰§è¡Œä¸€æ¬¡ onInterval()
local handle = Scheduler.scheduleGlobal(onInterval, 0.5)

~~~

@param function listener å›è°ƒå‡½æ•°
@param number interval é—´éš”æ—¶é—´

@return mixed scheduleå¥æŸ„

]]
function Scheduler.scheduleGlobal(listener, interval)
    return schedulerIns:scheduleScriptFunc(function( ... )
    	if listener then
    		listener(...)
    	end
    end, interval, false)
end


--[[--

å–æ¶ˆä¸€ä¸ªå…¨å±€è®¡åˆ’

Scheduler.unscheduleGlobal() çš„å‚æ•°å°±æ?¯ Scheduler.scheduleUpdateGlobal() å’Œ Scheduler.scheduleGlobal() çš„è¿”å›å€¼ã€‚

@param mixed scheduleå¥æŸ„

]]
function Scheduler.unscheduleGlobal(handle)
    schedulerIns:unscheduleScriptEntry(handle)
end

--[[--

è®¡åˆ’ä¸€ä¸ªå…¨å±€å»¶æ—¶å›è°ƒï¼Œå¹¶è¿”å›è¯¥è®¡åˆ’çš„å¥æŸ„ã€‚

scheduler.performWithDelayGlobal() ä¼šåœ¨ç­‰å¾…æŒ‡å®šæ—¶é—´åæ‰§è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ï¼Œç„¶åè‡ªåŠ¨å–æ¶ˆè¯¥è®¡åˆ’ã€‚

@param function listener å›è°ƒå‡½æ•°
@param number time å»¶è¿Ÿæ—¶é—´

@return mixed scheduleå¥æŸ„

]]
function Scheduler.performWithDelayGlobal(listener, time)
    local handle
    handle = schedulerIns:scheduleScriptFunc(function(...)
        Scheduler.unscheduleGlobal(handle)
        listener(...)
    end, time, false)
    return handle
end

return Scheduler
